apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: agentclasses.neuronetes.io
  annotations:
    controller-gen.kubebuilder.io/version: v0.11.0
spec:
  group: neuronetes.io
  names:
    kind: AgentClass
    listKind: AgentClassList
    plural: agentclasses
    shortNames:
    - ac
    singular: agentclass
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: AgentClass is the Schema for the agentclasses API
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation of an object.'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this object represents.'
            type: string
          metadata:
            type: object
          spec:
            description: AgentClassSpec defines the desired state of AgentClass
            properties:
              modelRef:
                description: ModelRef references the Model to use
                properties:
                  name:
                    description: Name of the referenced Model
                    type: string
                required:
                - name
                type: object
              maxContextLength:
                description: MaxContextLength is the maximum context length in tokens
                format: int32
                type: integer
              systemPrompt:
                description: SystemPrompt is the system prompt for the agent
                type: string
              temperature:
                description: Temperature controls randomness in responses
                type: string
              maxTokens:
                description: MaxTokens is the maximum tokens in response
                format: int32
                type: integer
              toolPermissions:
                description: ToolPermissions defines allowed tools and their rate limits
                items:
                  description: ToolPermission defines permission for a single tool
                  properties:
                    name:
                      description: Name of the tool
                      type: string
                    rateLimit:
                      description: RateLimit in format "N/period" (e.g., "100/min")
                      type: string
                    timeout:
                      description: Timeout for tool execution
                      type: string
                    maxConcurrency:
                      description: MaxConcurrency limits concurrent tool executions
                      format: int32
                      type: integer
                    requiredScopes:
                      description: RequiredScopes are the scopes needed for this tool
                      items:
                        type: string
                      type: array
                  required:
                  - name
                  type: object
                type: array
              guardrails:
                description: Guardrails define safety checks for the agent
                items:
                  description: Guardrail defines a single guardrail configuration
                  properties:
                    type:
                      description: Type of guardrail
                      enum:
                      - pii-detection
                      - safety-check
                      - content-filter
                      - jailbreak-detection
                      - toxicity-check
                      type: string
                    action:
                      description: Action to take when guardrail triggers
                      enum:
                      - block
                      - redact
                      - warn
                      - log
                      type: string
                    threshold:
                      description: Threshold for triggering (0.0-1.0)
                      type: string
                  required:
                  - type
                  - action
                  type: object
                type: array
              slo:
                description: SLO defines service level objectives
                properties:
                  ttft:
                    description: TTFT (Time to First Token) target
                    type: string
                  tokensPerSecond:
                    description: TokensPerSecond throughput target
                    format: int32
                    type: integer
                  p95Latency:
                    description: P95Latency is the 95th percentile latency target
                    type: string
                  maxCostPerRequest:
                    description: MaxCostPerRequest in USD
                    type: string
                  availabilityPercent:
                    description: AvailabilityPercent target (e.g., 99.9)
                    type: string
                type: object
              memoryConfig:
                description: MemoryConfig defines agent memory configuration
                properties:
                  type:
                    description: Type of memory store
                    enum:
                    - ephemeral
                    - redis
                    - dynamodb
                    type: string
                  ttl:
                    description: TTL for memory entries
                    type: string
                  maxSize:
                    description: MaxSize limits memory entries
                    format: int32
                    type: integer
                  encrypted:
                    description: Encrypted enables encryption at rest
                    type: boolean
                  connectionString:
                    description: ConnectionString for external store
                    type: string
                required:
                - type
                type: object
            required:
            - modelRef
            type: object
          status:
            description: AgentClassStatus defines the observed state of AgentClass
            properties:
              conditions:
                description: Conditions represent the latest available observations
                items:
                  properties:
                    lastTransitionTime:
                      format: date-time
                      type: string
                    message:
                      type: string
                    reason:
                      type: string
                    status:
                      type: string
                    type:
                      type: string
                  required:
                  - lastTransitionTime
                  - status
                  - type
                  type: object
                type: array
              phase:
                description: Phase represents the current phase
                enum:
                - Pending
                - Ready
                - Degraded
                - Failed
                type: string
              activePoolCount:
                description: ActivePoolCount is the number of active pools using this class
                format: int32
                type: integer
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
    additionalPrinterColumns:
    - name: Model
      type: string
      jsonPath: .spec.modelRef.name
    - name: Context
      type: integer
      jsonPath: .spec.maxContextLength
    - name: Phase
      type: string
      jsonPath: .status.phase
    - name: Age
      type: date
      jsonPath: .metadata.creationTimestamp
